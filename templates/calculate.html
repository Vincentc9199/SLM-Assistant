{% extends "base.html" %}

{% block content %}

<h2>Calculate: Input Coordinates</h2>

<script>
    function addPoint() {
        var container = document.getElementById("coordinates-container");
        var pointDiv = document.createElement("div");
        pointDiv.className = "point";
        pointDiv.innerHTML = `
            <input type="number" name="x_coords" placeholder="x" required>
            <input type="number" name="y_coords" placeholder="y" required>
            <input type="number" name="amplitudes" placeholder="amplitude" step="any" required>
            <button type="button" onclick="removePoint(this)">Remove</button>
        `;
        container.appendChild(pointDiv);
    }

    function removePoint(button) {
        var pointDiv = button.parentElement;
        pointDiv.remove();
    }
</script>

<h3>Input Coordinates</h3>
<form id ="mainform" method="post">
    <div id="coordinates-container">
        <div class="point">
            <input type="number" name="x_coords" placeholder="x" required>
            <input type="number" name="y_coords" placeholder="y" required>
            <input type="number" name="amplitudes" placeholder="amplitude" step="any" required>
        </div>
    </div>
    <button type="button" onclick="addPoint()">Add Point</button><br><br>
    <label for="iteration_number">Number of Iterations:</label>
    <input type="number" id="iteration_number" name="iteration_number"><br><br>
    <label for="guess_path">Initial Guess File Path:</label>
    <input type="text" id="guess_path" name="guess_path"><br><br>
    <label for="save_path">Save File Path:</label>
    <input type="text" id="save_path" name="save_path"><br><br>
    <label for="save_name">Save Name:</label>
    <input type="text" id="save_name" name="save_name" required><br><br>
    <input type="submit" value="Start Calculation">
</form>
 
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js" integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO" crossorigin="anonymous"></script>

<script type = "text/javascript">
    window.onload = function () {
        const socket = io();
        socket.connect("http://127.0.0.1:8080");
        socket.on("connect", function () {
            console.log("Connected");
        })
        socket.on("update progress", function(percent) {
            // do something with percent
            console.log("Got percent: " + percent)
        })
    }
</script>

<div class="progress" role="progressbar" aria-label="Basic example" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">
    <div class="progress-bar" style="width:10%">10%</div>
</div>

<h2>Calculation Plots</h2>
    
    <img src="{{ url_for('static', filename='images/slmplane.png') }}" class="img-fluid" alt="Nearfield Plot">
    <img src="{{ url_for('static', filename='images/farfield.png') }}" class="img-fluid" alt="Farfield Plot">
    <img src="{{ url_for('static', filename='images/stats.png') }}" class="img-fluid" alt="Statistics Plot">
{% endblock %}